$(function(){
	alert('Test accounts');

    var Task = Backbone.Model.extend({
    	url : function() {
    		return this.id ? '/task/' + this.id : '/task';
    	}
    });

    var TaskCollection = Backbone.Collection.extend({
        model: Task,
        url: '/tasks'
    });
    var taskCollection = new TaskCollection();
    taskCollection.fetch();

	TasklistView = Backbone.View.extend({
		initialize: function(){
			this.render();
		},
		events: {
            "click input[type=button]": "addTask"
        },
        addTask: function( event ){
            // Button clicked, you can access the element that was clicked with event.currentTarget
            alert( "Create task " + $("#task_name").val() );
            var newTask = new Task({name:$("#task_name").val()});
            this.model.save({
				success: function(model, response){
					alert("saved");
				},
				error: function(){
					alert("error");
				}
			});

            
            alert("Saved task: " + newTask.id);
            newTask.set({name: 'another name'});
            newTask.save();
        },
		render: function(){
			// Compile the template using underscore
			var template = _.template( $("#tasklist_template").html(), {} );
			this.el.html( template );
		}
	});
	
	var tasklistView = new TasklistView({ el: $("#tasklist_container") });
});